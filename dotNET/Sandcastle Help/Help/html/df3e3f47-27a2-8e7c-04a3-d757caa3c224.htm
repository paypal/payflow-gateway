<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AuthorizationTransaction.CreateSecureToken Property </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CreateSecureToken property" /><meta name="System.Keywords" content="AuthorizationTransaction.CreateSecureToken property" /><meta name="Microsoft.Help.F1" content="PayPal.Payments.Transactions.AuthorizationTransaction.CreateSecureToken" /><meta name="Microsoft.Help.F1" content="PayPal.Payments.Transactions.AuthorizationTransaction.get_CreateSecureToken" /><meta name="Microsoft.Help.F1" content="PayPal.Payments.Transactions.AuthorizationTransaction.set_CreateSecureToken" /><meta name="Microsoft.Help.Id" content="P:PayPal.Payments.Transactions.AuthorizationTransaction.CreateSecureToken" /><meta name="Description" content="Gets, Sets CreateSecureToken. This property is used to create a SecureToken." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="PayPal.Payments.Transactions" /><meta name="file" content="df3e3f47-27a2-8e7c-04a3-d757caa3c224" /><meta name="guid" content="df3e3f47-27a2-8e7c-04a3-d757caa3c224" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Payflow Gateway .NET SDK v5<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/560a6b31-acc3-49c1-9659-71770df29342.htm" title="Payflow Gateway .NET SDK v5" tocid="roottoc">Payflow Gateway .NET SDK v5</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/21e6fa9e-f96d-48bd-5e92-9a98c23fc7f3.htm" title="PayPal.Payments.Transactions" tocid="21e6fa9e-f96d-48bd-5e92-9a98c23fc7f3">PayPal.Payments.Transactions</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/c9ada35a-3463-236a-4e41-f12196510960.htm" title="AuthorizationTransaction Class" tocid="c9ada35a-3463-236a-4e41-f12196510960">AuthorizationTransaction Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/090f00ca-ccbc-3780-e9c2-7eb529f7fae0.htm" title="AuthorizationTransaction Properties" tocid="090f00ca-ccbc-3780-e9c2-7eb529f7fae0">AuthorizationTransaction Properties</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/df3e3f47-27a2-8e7c-04a3-d757caa3c224.htm" title="CreateSecureToken Property " tocid="df3e3f47-27a2-8e7c-04a3-d757caa3c224">CreateSecureToken Property </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/45934b7a-9fab-77ef-8fe6-c93f208cf267.htm" title="OrigId Property " tocid="45934b7a-9fab-77ef-8fe6-c93f208cf267">OrigId Property </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/957256d7-1594-bd6c-2810-5504930ec8f8.htm" title="PartialAuth Property " tocid="957256d7-1594-bd6c-2810-5504930ec8f8">PartialAuth Property </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/35855e36-dc03-79d9-83d6-86ec8b9d5f75.htm" title="SecureTokenId Property " tocid="35855e36-dc03-79d9-83d6-86ec8b9d5f75">SecureTokenId Property </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>AuthorizationTransaction<span id="LST2BBF50AD_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST2BBF50AD_0?cpp=::|nu=.");</script>CreateSecureToken Property </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Gets, Sets CreateSecureToken. This property is used to create a SecureToken.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="21e6fa9e-f96d-48bd-5e92-9a98c23fc7f3.htm">PayPal.Payments.Transactions</a><br />
    <strong>Assembly:</strong>
   Payflow_dotNET (in Payflow_dotNET.dll) Version: 0.0.0.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">string</span> <span class="identifier">CreateSecureToken</span> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Property</span> <span class="identifier">CreateSecureToken</span> <span class="keyword">As</span> <span class="identifier">String</span>
	<span class="keyword">Get</span>
	<span class="keyword">Set</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Property Value</h4>Type: <a href="https://docs.microsoft.com/dotnet/api/system.string" target="_blank">String</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection">Use a secure token to send non-credit card transaction data to the Payflow server for storage in
             a way that can’t be intercepted and manipulated maliciously.The secure token must be used with the hosted 
             checkout pages. The token is good for a one-time transaction and is valid for 30 minutes.
             
             NOTE: Without using a secure token, Payflow Pro merchants can host their own payment page and Payflow Link merchants 
             can use a form post to send transaction data to the hosted checkout pages. However, by not using the secure token, 
             these Payflow gateway users are responsible for the secure handling of data.  To obtain a secure token, pass a unique, 
             36-character token ID and set CREATESECURETOKEN=Y in a request to the Payflow server. The Payflow server associates your 
             ID with a secure token and returns the token as a string of up to 32 alphanumeric characters.  To pass the transaction 
             data to the hosted checkout page, you pass the secure token and token ID in an HTTP form post. The token and ID trigger 
             the Payflow server to retrieve your data and display it for buyer approval. 
             
             See the DOSecureTokenAuth sample for more information.
             <div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBABBA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBABBA','cs','1','2');return false;">C#</a></div><div id="ID0EBABBA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBABBA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBABBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBABBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBABBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">   ..........
   ..........
   <span class="highlight-comment">//Populate required data objects.</span>
   ..........
   ..........

<span class="highlight-comment">// Since we are using the hosted payment pages, you will not be sending the credit card data with the </span>
<span class="highlight-comment">// Secure Token Request.  You just send all other 'sensitive' data within this request and when you</span>
<span class="highlight-comment">// call the hosted payment pages, you'll only need to pass the SECURETOKEN; which is generated and returned</span>
<span class="highlight-comment">// and the SECURETOKENID that was created and used in the request.</span>

<span class="highlight-comment">// Create a new Secure Token Authorization Transaction.  Even though this example is performing</span>
<span class="highlight-comment">// an authorization, you can create a secure token using SaleTransction too.  Only Authorization and Sale</span>
<span class="highlight-comment">// type transactions are permitted.</span>
   <span class="highlight-comment">//Create a new Authorization Transaction.</span>
    AuthorizationTransaction Trans = <span class="highlight-keyword">new</span> AuthorizationTransaction(
                                           UserInfo,
                                           PayflowConnectionData,
                                           Invoice,
                                           Tender, 
                                           RequestId);
   <span class="highlight-comment">// Set the flag to create a Secure Token.</span>
   Trans.CreateSecureToken = <span class="highlight-literal">"Y"</span>;
   <span class="highlight-comment">// The Secure Token Id must be a unique id up to 36 characters.  Using the RequestID object to generate </span>
   <span class="highlight-comment">// a random id, but any means to create an id can be used.</span>
   Trans.SecureTokenId = PayflowUtility.RequestId;

   <span class="highlight-comment">//Submit the transaction.</span>
   Trans.SubmitTransaction();

   <span class="highlight-comment">// Get the Response.</span>
   Response Resp = Trans.Response;
   <span class="highlight-keyword">if</span> (Resp != <span class="highlight-keyword">null</span>)
   {
       <span class="highlight-comment">// Get the Transaction Response parameters.</span>
       TransactionResponse TrxnResponse =  Resp.TransactionResponse;
       <span class="highlight-keyword">if</span> (TrxnResponse != <span class="highlight-keyword">null</span>)
   {
       Console.WriteLine(<span class="highlight-literal">"RESULT = "</span> + TrxnResponse.Result);
       Console.WriteLine(<span class="highlight-literal">"RESPMSG = "</span> + TrxnResponse.RespMsg);
       Console.WriteLine(<span class="highlight-literal">"SECURETOKEN = "</span> + TrxnResponse.SecureToken);
       Console.WriteLine(<span class="highlight-literal">"SECURETOKENID = "</span> + TrxnResponse.SecureTokenId);
       <span class="highlight-comment">// If value is true, then the Request ID has not been changed and the original response</span>
       <span class="highlight-comment">// of the original transaction is returned. </span>
       Console.WriteLine(<span class="highlight-literal">"DUPLICATE = "</span> + TrxnResponse.Duplicate);
   }
   }
   <span class="highlight-comment">// Get the Context and check for any contained SDK specific errors.</span>
   Context Ctx = Resp.TransactionContext;
   <span class="highlight-keyword">if</span> (Ctx != <span class="highlight-keyword">null</span> ++ Ctx.getErrorCount() &gt; <span class="highlight-number">0</span>)
   {
       Console.WriteLine(Environment.NewLine + <span class="highlight-literal">"Errors = "</span> + Ctx.ToString());
   }</pre></div><div id="ID0EBABBA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">           ..........
           ..........
           'Populate required data objects.
           ..........
           ..........

' Since we are using the hosted payment pages, you will not be sending the credit card data with the 
' Secure Token Request.  You just send all other 'sensitive' data within this request and when you
' call the hosted payment pages, you'll only need to pass the SECURETOKEN; which is generated and returned
' and the SECURETOKENID that was created and used in the request.

' Create a new Secure Token Authorization Transaction.  Even though this example is performing
' an authorization, you can create a secure token using SaleTransction too.  Only Authorization and Sale
' type transactions are permitted.
           'Create a new Authorization Transaction.
           Dim Trans as New AuthorizationTransaction(UserInfo, PayflowConnectionData, Invoice, Tender, RequestId)
           ' See the CreateSecureToken parameter to yes "Y", to flag this transaction request to create a secure token.
           Trans.CreateSecureToken = "Y"

' The Secure Token Id must be a unique id up to 36 characters.  Using the RequestID object to 
' generate a random id, but any means to create an id can be used.
Trans.SecureTokenId = PayflowUtility.RequestId

           ' Submit the transaction.
           Trans.SubmitTransaction()

           ' Get the Response.
           Dim Resp As Response = Trans.Response

           If Not Resp Is Nothing Then
           ' Get the Transaction Response parameters.

                   Dim TrxnResponse As TransactionResponse = Resp.TransactionResponse

                   If Not TrxnResponse Is Nothing Then
       Console.WriteLine("RESULT = " + TrxnResponse.Result.ToString)
       Console.WriteLine("RESPMSG = " + TrxnResponse.RespMsg)
       Console.WriteLine("SECURETOKEN = " + TrxnResponse.SecureToken)
       Console.WriteLine("SECURETOKENID = " + TrxnResponse.SecureTokenId)
       ' If value is true, then the Request ID has not been changed and the original response
       ' of the original transaction is returned. 
       Console.WriteLine("DUPLICATE = " + TrxnResponse.Duplicate)
                   End If
           End If

           ' Get the Context and check for any contained SDK specific errors.
           Dim Ctx As Context = Resp.TransactionContext

           If Not Ctx Is Nothing AndAlso Ctx.getErrorCount() &gt; 0 Then
                   Console.WriteLine(Constants.vbLf + "Errors = " + Ctx.ToString())
           End If</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBABBA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="c9ada35a-3463-236a-4e41-f12196510960.htm">AuthorizationTransaction Class</a></div><div class="seeAlsoStyle"><a href="21e6fa9e-f96d-48bd-5e92-9a98c23fc7f3.htm">PayPal.Payments.Transactions Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:DL-PayPal-Payflow-SDK%40paypal.com?Subject=Payflow%20Gateway%20.NET%20SDK%20v5">DL-PayPal-Payflow-SDK@paypal.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>